# UAT Issues: Phase 13.2 Plan 01

**Tested:** 2026-01-20
**Source:** .planning/phases/13.2-darkroom-auto-reveal-fix/13.2-01-SUMMARY.md
**Tester:** User via /gsd:verify-work

## Open Issues

### UAT-001: Darkroom reveal requires app activity - need server-side reveal

**Discovered:** 2026-01-20
**Phase/Plan:** 13.2-01
**Severity:** Major
**Feature:** Darkroom auto-reveal
**Description:** The current implementation only reveals photos when the app is active (foreground check) or when user captures a new photo. For the reveal notification to work properly, photos need to reveal regardless of app state - even when the app is completely closed.
**Expected:** Photos should reveal at exactly nextRevealAt time, regardless of whether the app is open, closed, or backgrounded. The push notification should fire at reveal time.
**Actual:** Photos only reveal when:
1. User captures a new photo (triggers ensureDarkroomInitialized)
2. App comes to foreground (triggers AppState listener)

If user never opens the app, photos remain in "developing" forever and notifications can't accurately notify "photos ready".

**Root Cause:** Reveal logic runs client-side in React Native. There's no server-side scheduled task to reveal photos.

**Required Solution:**
- Add a Firebase Cloud Function (scheduled or triggered) that:
  1. Periodically checks all darkroom documents for `nextRevealAt <= now`
  2. Reveals overdue photos server-side
  3. Triggers push notification at actual reveal time
- This is how real Lapse likely works - server controls reveal timing

**Architectural Impact:**
- Requires new Cloud Function (scheduled, runs every 1-5 minutes)
- Server-side photo reveal logic (query developing photos, batch update to revealed)
- Notification triggers from server at reveal time, not from client

## Resolved Issues

[None yet]

---

*Phase: 13.2-darkroom-auto-reveal-fix*
*Plan: 01*
*Tested: 2026-01-20*
