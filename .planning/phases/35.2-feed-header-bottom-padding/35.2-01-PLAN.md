---
phase: 35.2-feed-header-bottom-padding
plan: 01
type: execute
---

<objective>
Polish feed UX with scroll-aware header and proper content spacing, plus reposition story segments in modal.

Purpose: Create Instagram-quality feed scrolling experience where header hides smoothly to maximize photo viewing space, content doesn't clip behind tab bar, and modal layout follows bottom-up information hierarchy.
Output: Smooth scroll-hide header, proper bottom padding, and repositioned progress bar in stories modal.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/35.2-feed-header-bottom-padding/35.2-CONTEXT.md
@.planning/phases/35.1-unified-photo-modal/35.1-01-SUMMARY.md

**Key files:**
@src/screens/FeedScreen.js
@src/components/PhotoDetailModal.js
@src/styles/PhotoDetailModal.styles.js

**Tech stack available:**

- React Native Animated API (already used in PhotoDetailModal)
- FlatList onScroll event
- useRef for scroll tracking

**Established patterns:**

- Animated.Value for smooth animations (from PhotoDetailModal swipe-to-dismiss)
- StatusBar.currentHeight for safe area calculations
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Implement scroll-hide header with black background</name>
  <files>src/screens/FeedScreen.js</files>
  <action>
Convert FeedScreen header to animated scroll-hide behavior:

1. Add Animated import and create scrollY Animated.Value (useRef)
2. Change header backgroundColor from colors.background.secondary to '#000000' (pure black)
3. Wrap header View in Animated.View
4. Calculate header transform using scrollY.interpolate():
   - inputRange: [0, HEADER_HEIGHT] (where HEADER_HEIGHT = ~68 based on current padding)
   - outputRange: [0, -HEADER_HEIGHT]
   - extrapolate: 'clamp'
5. Add onScroll to FlatList with Animated.event:
   ```
   onScroll={Animated.event(
     [{ nativeEvent: { contentOffset: { y: scrollY } } }],
     { useNativeDriver: true }
   )}
   scrollEventThrottle={16}
   ```
6. Add position: 'absolute', top: 0, left: 0, right: 0, zIndex: 10 to header style (so content scrolls under it)
7. Add paddingTop equal to HEADER_HEIGHT to FlatList contentContainerStyle so first content isn't hidden behind header
8. Remove borderBottomWidth/borderBottomColor from header (cleaner look)

**Why clamp extrapolation:** Prevents header from moving beyond bounds when scrolling past edges (bounce).
**Why useNativeDriver:** Smooth 60fps animation without JS thread blocking.
</action>
<verify>Run app, scroll feed down - header should smoothly slide up and disappear. Scroll up - header should slide back down.</verify>
<done>Header slides up/down smoothly tracking scroll position, black background, no visual jank</done>
</task>

<task type="auto">
  <name>Task 2: Add bottom padding for tab bar clearance</name>
  <files>src/screens/FeedScreen.js</files>
  <action>
Add proper bottom padding to FlatList content:

1. Define TAB_BAR_HEIGHT constant (~88 for iOS with safe area, adjust if needed)
2. Update feedList style contentContainerStyle:
   - Change paddingBottom from 24 to TAB_BAR_HEIGHT + 24 (so last card's info section fully visible)
3. This ensures the last feed card's reaction count, name, and timestamp aren't clipped by bottom tab bar

**Why TAB_BAR_HEIGHT + 24:** Tab bar height plus breathing room for comfortable viewing.
</action>
<verify>Scroll to bottom of feed - last card's info row (profile pic, name, reaction counts) should be fully visible above tab bar</verify>
<done>Last feed card fully visible above tab bar with comfortable padding</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Scroll-hide header and bottom padding for feed</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Open app on device/simulator
    3. Navigate to Feed tab
    4. Test header behavior:
       - Scroll down through feed - header should smoothly slide up and hide
       - Scroll up - header should smoothly slide back down
       - Quick scroll should feel responsive (velocity-aware via native driver)
    5. Test bottom padding:
       - Scroll to very bottom of feed
       - Last card's info section (profile pic, name, reactions) should be fully visible above tab bar
    6. Confirm: No visual glitches, smooth 60fps animation, content doesn't jump
  </how-to-verify>
  <resume-signal>Type "approved" to continue with modal changes, or describe issues to fix</resume-signal>
</task>

<task type="auto">
  <name>Task 3: Reposition progress bar to bottom in stories modal</name>
  <files>src/components/PhotoDetailModal.js, src/styles/PhotoDetailModal.styles.js</files>
  <action>
Move progress bar from top to bottom of modal (below user info, above emoji reactions):

In PhotoDetailModal.js:

1. Move the progress bar JSX from above the header to above the footer (below userInfoOverlay)
2. The new layout order should be:
   - Header (close button at top)
   - Photo
   - Profile pic (overlapping top left - no change)
   - User info (name + timestamp) - currently bottom left
   - Progress bar (NEW position - below user info, only in stories mode)
   - Footer (emoji reactions)

In PhotoDetailModal.styles.js:

1. Update progressBarContainer style:
   - Remove paddingTop: (StatusBar.currentHeight || 54) + 8
   - Add positioning to place it above footer: paddingBottom: 8, paddingHorizontal: 24
   - Keep flexDirection: 'row', gap: 4
2. Update userInfoOverlay bottom position to make room for progress bar:
   - Change bottom: 108 to bottom: 140 (roughly 32px more for progress bar height)
3. Ensure progress bar only renders when showProgressBar is true (stories mode)

**Why this order:** Natural information hierarchy - see who posted, when, how far through their story, then react.
</action>
<verify>Open a friend's story from feed - progress bar should appear below name/timestamp, above emoji reactions. Progress bar should NOT appear for regular feed photo taps.</verify>
<done>Progress bar positioned at bottom in stories mode only, user info → progress bar → reactions vertical flow</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Header smoothly hides on scroll down, shows on scroll up
- [ ] Header has pure black background (#000000)
- [ ] Feed content has proper bottom padding above tab bar
- [ ] Progress bar appears at bottom of modal in stories mode
- [ ] Progress bar does NOT appear in feed mode
- [ ] No TypeScript/lint errors
- [ ] App runs without crashes
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No console errors or warnings introduced
- Feed scrolling feels buttery smooth (60fps)
- User can see last feed card fully above tab bar
- Stories modal has logical bottom-up layout (info → progress → reactions)
  </success_criteria>

<output>
After completion, create `.planning/phases/35.2-feed-header-bottom-padding/35.2-01-SUMMARY.md`:

# Phase 35.2 Plan 01: Feed Header & Bottom Padding Summary

**[Substantive one-liner]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

[Ready for Phase 36 (Comments Feature)]
</output>
