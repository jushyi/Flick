---
phase: 08-polish-testing
plan: 02
type: execute
---

<objective>
Polish phone authentication UX with consistent phone number formatting and improved error messages.

Purpose: Enhance user experience with clear, formatted phone numbers and helpful error messages throughout auth flow.
Output: Polished phone auth screens with professional formatting and user-friendly error handling.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**From 08-01-SUMMARY.md (to be created):**
- Phone auth cleanup committed
- Error boundaries in place

**Current state:**
- PhoneInputScreen shows formatted number in country code display
- VerificationScreen shows formatted number from route params
- Phone numbers stored in E.164 format in Firestore

**Key files:**
@src/screens/PhoneInputScreen.js
@src/screens/VerificationScreen.js
@src/services/firebase/phoneAuthService.js
@src/utils/logger.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add phone number formatting utility and improve display</name>
  <files>src/utils/phoneUtils.js, src/screens/PhoneInputScreen.js, src/screens/VerificationScreen.js</files>
  <action>
Create phoneUtils.js with formatting helpers:
1. formatPhoneForDisplay(e164, countryCode) - Returns formatted string like "(415) 555-1234"
2. formatPhoneWithCountry(e164) - Returns string like "+1 (415) 555-1234" for display

Update PhoneInputScreen:
- Show formatted preview as user types (e.g., "(415) 555-" as they enter 4155555)
- Use AsYouType formatter from libphonenumber-js
- Format phone in real-time without blocking input

Update VerificationScreen:
- Display phone number consistently with country code
- Show "+1 (415) 555-1234" format instead of raw E.164

Do NOT change how phone numbers are stored or validated - only display formatting.
  </action>
  <verify>
1. phoneUtils.js exists with formatPhoneForDisplay and formatPhoneWithCountry functions
2. PhoneInputScreen shows formatted preview as user types
3. VerificationScreen displays phone in friendly format with country code
  </verify>
  <done>Phone numbers display in consistent, user-friendly format throughout auth flow</done>
</task>

<task type="auto">
  <name>Task 2: Improve error message UX in auth screens</name>
  <files>src/screens/PhoneInputScreen.js, src/screens/VerificationScreen.js, src/services/firebase/phoneAuthService.js</files>
  <action>
Improve error handling UX:

1. PhoneInputScreen error improvements:
   - Add inline error styling (red border on input when error)
   - Show specific error message below phone input field
   - Clear error when user starts typing
   - Add slight shake animation on error (optional, use Animated API if simple)

2. VerificationScreen error improvements:
   - Show error message below code input
   - Clear code field and refocus on error
   - Add countdown before allowing retry (prevent rapid retries)
   - Show "Incorrect code" more prominently

3. phoneAuthService improvements:
   - Add more specific error messages for edge cases
   - Improve logging detail for debugging
   - Handle network errors with retry suggestion

Keep existing error messages but enhance visual presentation.
  </action>
  <verify>
1. PhoneInputScreen shows inline error styling on validation failure
2. VerificationScreen clears code and shows error clearly on wrong code
3. Error states are visually distinct (red border, red text)
4. Errors clear when user starts typing/entering code
  </verify>
  <done>Error messages are clear, visually prominent, and help users recover from errors</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] phoneUtils.js exists with formatting functions
- [ ] Phone numbers display in friendly format on both screens
- [ ] Error states have visual styling (red border)
- [ ] Test: Enter invalid number, verify error styling appears
- [ ] Test: Enter wrong code, verify error message and code clearing
</verification>

<success_criteria>

- Phone number formatting is consistent and user-friendly
- Error states are visually clear and help users recover
- No regressions in phone auth flow
- All verification checks pass
</success_criteria>

<output>
After completion, create `.planning/phases/08-polish-testing/08-02-SUMMARY.md`
</output>
