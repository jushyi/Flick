---
phase: 17.1-darkroom-animation-refinements
plan: 01
type: execute
---

<objective>
Improve darkroom open/close animations and create inline success state for seamless triage completion.

Purpose: Make the darkroom feel like a native iOS drawer/sheet with smooth bottom-up/down animations, and eliminate the jarring navigation jump when triage completes.
Output: Darkroom slides up from bottom to open, down to close, with inline success state that reveals under the last swiped card.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17.1-darkroom-animation-refinements/17.1-CONTEXT.md
@.planning/phases/17-darkroom-ux-polish/17-02-SUMMARY.md

**Key files:**
@src/navigation/AppNavigator.js
@src/screens/DarkroomScreen.js
@src/screens/SuccessScreen.js

**Tech stack available:**
- react-native-reanimated for animations
- expo-haptics for tactile feedback
- React Navigation 7.x for screen navigation

**Established patterns:**
- GestureDetector + Gesture.Pan() for swipeable cards
- Animated overlays with interpolate() for opacity
- Separate animation durations for button vs swipe gestures

**Constraining decisions:**
- Phase 17: Removed down-swipe delete gesture, fixed arc path formula
- Phase 17-FIX-4: Cascading prop for parallel animation sync
</context>

<tasks>

<task type="auto">
  <name>Task 1: Change Darkroom navigation to slide-from-bottom</name>
  <files>src/navigation/AppNavigator.js</files>
  <action>
Update the Darkroom screen options in AppNavigator.js:
- Change `animation: 'slide_from_right'` to `animation: 'slide_from_bottom'`
- This makes the Darkroom feel like a native iOS sheet sliding up from the bottom

Note: React Navigation's `slide_from_bottom` is the correct animation name for v7.x.
  </action>
  <verify>App loads without error, navigating to Darkroom shows slide-up animation</verify>
  <done>Darkroom screen slides up from bottom when opened instead of from the right</done>
</task>

<task type="auto">
  <name>Task 2: Change back button to down-pointing chevron</name>
  <files>src/screens/DarkroomScreen.js</files>
  <action>
Update the back button in DarkroomScreen header:
- Replace the left-pointing `‹` character with a down-pointing chevron `⌄` or similar
- The icon should indicate that tapping dismisses the sheet downward
- Keep the same button styling (40x40 circular, rgba(255,255,255,0.1) background)
- Also update the empty state back button to match

Consider using a View-based icon for cleaner rendering:
```jsx
<View style={styles.downChevron} />
// with styles:
downChevron: {
  width: 12,
  height: 12,
  borderBottomWidth: 2,
  borderRightWidth: 2,
  borderColor: '#FFFFFF',
  transform: [{ rotate: '45deg' }],
  marginTop: -4,
}
```
  </action>
  <verify>Back button displays down-pointing chevron, tapping still calls navigation.goBack()</verify>
  <done>Back button icon points downward to indicate dismiss direction</done>
</task>

<task type="auto">
  <name>Task 3: Create inline success state instead of navigating to Success screen</name>
  <files>src/screens/DarkroomScreen.js</files>
  <action>
Replace navigation to Success screen with an inline success state:

1. Add state to track triage completion:
   - `const [triageComplete, setTriageComplete] = useState(false);`

2. When last photo is triaged (isLastPhoto check in handleTriage):
   - Instead of `navigation.navigate('Success')`, set `setTriageComplete(true)`
   - Add a small delay (200-400ms) to let the last card's exit animation complete

3. Create inline success view that renders when triageComplete && photos.length === 0:
   - Dark background (#000000) with fade-in animation
   - Subtle confetti animation (reuse ConfettiPiece from SuccessScreen but with fewer pieces: 12-15)
   - "Photos saved!" title text (centered, white, 24px bold)
   - "Done" button (blue #007AFF, rounded, navigates to Camera tab)
   - Success haptic feedback on mount

4. Add fade-in animation for the success state:
   - Use Animated.Value for opacity
   - Animate from 0 to 1 over 300ms when triageComplete becomes true

5. Handle Done button press:
   - Navigate to MainTabs Camera screen: `navigation.navigate('MainTabs', { screen: 'Camera' })`

Key: The success state should fade IN as the last card animates OUT via swipe, creating a seamless reveal effect.
  </action>
  <verify>After triaging last photo, success state fades in with confetti and Done button, no navigation jump</verify>
  <done>Triage completion shows inline success state with confetti, no separate Success screen navigation</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Darkroom animation refinements: bottom slide, down chevron, inline success</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Open app on device, capture a test photo
    3. Wait for photo to reveal, open Darkroom
    4. Verify: Darkroom slides UP from bottom (not from right)
    5. Verify: Back button has down-pointing chevron icon
    6. Tap back button: Verify darkroom slides DOWN to close
    7. Reopen darkroom, swipe photo to archive/journal
    8. Verify: When last photo is triaged, success state fades in underneath (no navigation jump)
    9. Verify: Confetti animation plays (subtle, ~12-15 pieces)
    10. Verify: "Photos saved!" message and Done button visible
    11. Tap Done: Verify returns to Camera screen
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] Darkroom slides from bottom to open
- [ ] Darkroom slides to bottom to close
- [ ] Back button shows down-pointing chevron
- [ ] Last photo triage shows inline success (no navigation jump)
- [ ] Confetti animation plays on success
- [ ] Done button returns to Camera
- [ ] No console errors or warnings
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Darkroom feels like native iOS drawer/sheet
- Triage completion is seamless with inline success state
- No jarring navigation transitions
</success_criteria>

<output>
After completion, create `.planning/phases/17.1-darkroom-animation-refinements/17.1-01-SUMMARY.md`:

# Phase 17.1 Plan 01: Darkroom Animation Refinements Summary

**[Substantive one-liner about what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

[Ready for Phase 17.2: Reveal Timing 0-5 Minutes]
</output>
