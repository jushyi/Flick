---
phase: 17.1-darkroom-animation-refinements
plan: 01-FIX-2
type: fix
---

<objective>
Fix 1 UAT issue from plan 17.1-01 second round of testing.

Source: 17.1-01-ISSUES.md
Priority: 0 critical, 0 major, 1 minor
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

**Issues being fixed:**
@.planning/phases/17.1-darkroom-animation-refinements/17.1-01-ISSUES.md

**Original plan for reference:**
@.planning/phases/17.1-darkroom-animation-refinements/17.1-01-PLAN.md

**Current implementation:**
@src/screens/DarkroomScreen.js
</context>

<tasks>

<task type="auto">
  <name>Fix UAT-004: Header swipe moves entire screen, not just header</name>
  <files>src/screens/DarkroomScreen.js</files>
  <action>
The current implementation has `headerTranslateY` only applied to the header View via animated style. The fix is to:

1. Rename `headerTranslateY` to `screenTranslateY` (or similar) to reflect that it moves the whole screen
2. Instead of wrapping just the header in GestureDetector with animated style, either:
   - Wrap the ENTIRE screen content in an Animated.View with the translateY, OR
   - Apply the translateY to the container that holds all content (SafeAreaView or main content area)

The cleanest approach:
- Keep the GestureDetector on the header only (so swipe gesture is only triggered from header)
- BUT apply the `translateY` animated style to the outer container (e.g., the View with flex: 1 that contains everything)

Current code pattern:
```jsx
<SafeAreaView>
  <GestureDetector gesture={headerPanGesture}>
    <Animated.View style={[styles.header, headerAnimatedStyle]}>  // Only header moves
      ...header content
    </Animated.View>
  </GestureDetector>
  <View>...photo content</View>  // Doesn't move
  <View>...buttons</View>  // Doesn't move
</SafeAreaView>
```

Fixed pattern:
```jsx
<Animated.View style={[{ flex: 1 }, screenAnimatedStyle]}>  // Whole screen moves
  <SafeAreaView>
    <GestureDetector gesture={headerPanGesture}>
      <View style={styles.header}>  // Header is gesture target, but no longer animates separately
        ...header content
      </View>
    </GestureDetector>
    <View>...photo content</View>  // Now moves with screen
    <View>...buttons</View>  // Now moves with screen
  </SafeAreaView>
</Animated.View>
```

Steps:
1. Find the animated style `headerAnimatedStyle` that uses `headerTranslateY`
2. Rename to `screenAnimatedStyle` and update the useAnimatedStyle to use `screenTranslateY`
3. Rename `headerTranslateY` shared value to `screenTranslateY`
4. Move the animated style from the header View to an outer wrapper Animated.View that contains the entire screen content
5. Keep GestureDetector wrapping the header so gesture only triggers from header area
6. Remove animated style from the header View itself (it will move with the parent)
7. Ensure the opacity fade (`headerOpacity`) is also applied to the screen or removed

Note: The gesture handler updates need to stay the same (updating the shared value on drag, triggering close on threshold). Only the animated style application location changes.
  </action>
  <verify>
1. Run the app: `npx expo start`
2. Open darkroom with photos
3. Swipe down on the header
4. Verify the ENTIRE screen (header + photo + buttons) moves together as a cohesive unit
5. Verify swipe on photo area still triggers triage gestures (not close gesture)
6. Verify drag past threshold or fast swipe still closes the darkroom
  </verify>
  <done>
- Swiping down on header moves entire darkroom screen together
- Photo and button areas follow the header during drag
- Creates cohesive "pulling down a sheet" effect
- Photo area swipe still works for triage
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Header swipe gesture moves entire screen content together
- [ ] Photo triage swipes still work correctly (not intercepted by close gesture)
- [ ] Close threshold behavior unchanged (100px or velocity > 500)
- [ ] Spring-back animation works if threshold not met
- [ ] App builds without errors
</verification>

<success_criteria>
- UAT-004 from 17.1-01-ISSUES.md addressed
- Cohesive sheet-like swipe-to-close UX achieved
- No regressions to existing triage gestures
- Ready for re-verification
</success_criteria>

<output>
After completion, create `.planning/phases/17.1-darkroom-animation-refinements/17.1-01-FIX-2-SUMMARY.md`
</output>
