---
phase: 13-production-build-branding
plan: 03
type: execute
---

<objective>
Build iOS app with EAS and prepare for TestFlight distribution.

Purpose: Create a standalone iOS build that can be distributed to testers via TestFlight.
Output: Successful EAS build, app submitted to TestFlight.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/13-production-build-branding/13-01-SUMMARY.md
@.planning/phases/13-production-build-branding/13-02-SUMMARY.md

**EAS Configuration:**
@eas.json - Build profiles (development, preview, production)

**Requirements:**
- iOS build for TestFlight (internal testing)
- Bundle ID: com.oly.app (updated in Plan 01)
- Push notifications: development entitlements configured
- Firebase: GoogleService-Info.plist configured

**Build Profile:**
- Use "preview" profile for TestFlight (internal distribution)
- Or "production" for App Store Connect upload
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify EAS configuration</name>
  <files>eas.json, app.json</files>
  <action>
Verify EAS is properly configured for iOS build:

1. Check eas.json has iOS-appropriate build profiles
2. Verify app.json has:
   - ios.bundleIdentifier set to "com.oly.app"
   - ios.googleServicesFile pointing to valid plist
   - ios.entitlements for push notifications

3. If needed, update eas.json to add iOS-specific settings:
```json
{
  "build": {
    "preview": {
      "distribution": "internal",
      "ios": {
        "simulator": false
      }
    },
    "production": {
      "autoIncrement": true,
      "ios": {
        "image": "latest"
      }
    }
  }
}
```

4. Ensure EAS CLI is authenticated: `eas whoami`
  </action>
  <verify>
- eas.json has preview and production profiles
- app.json iOS config is complete
- `eas whoami` shows authenticated user
  </verify>
  <done>EAS configuration verified for iOS build</done>
</task>

<task type="auto">
  <name>Task 2: Run EAS build for iOS</name>
  <files>N/A (remote build)</files>
  <action>
Trigger EAS Build for iOS:

```bash
eas build --platform ios --profile preview
```

This will:
1. Upload project to EAS Build servers
2. Build the iOS app in the cloud
3. Generate an .ipa file for distribution

**Notes:**
- Build takes 10-20 minutes typically
- You may be prompted for Apple Developer credentials
- If credentials not configured, use `eas credentials` first
- Monitor build status at https://expo.dev/accounts/[owner]/projects/[project]/builds

**If Apple credentials needed:**
- Apple ID and App-specific password
- Or use `eas credentials` to set up automated credentials
  </action>
  <verify>
- Build submitted successfully (no immediate errors)
- Build ID returned
- Build status visible at expo.dev
  </verify>
  <done>EAS build submitted for iOS</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <action>Monitor EAS build and handle Apple Developer setup if needed</action>
  <instructions>
    Claude submitted the EAS build. You may need to:

    1. **Monitor build:** Watch https://expo.dev for build progress
    2. **Apple credentials:** If prompted, provide Apple Developer credentials
    3. **Provisioning:** EAS may need to create provisioning profiles

    The build typically takes 10-20 minutes. Wait for it to complete.

    Once build succeeds, you'll have an .ipa file ready for TestFlight.
  </instructions>
  <verification>Build status shows "Finished" at expo.dev</verification>
  <resume-signal>Type "build complete" when EAS build succeeds, or describe any errors</resume-signal>
</task>

<task type="auto">
  <name>Task 3: Submit to TestFlight</name>
  <files>N/A (remote submission)</files>
  <action>
Submit the built app to TestFlight:

```bash
eas submit --platform ios --latest
```

This will:
1. Download the latest successful build
2. Upload to App Store Connect
3. Automatically submit for TestFlight review

**Alternatively, use manual submission:**
1. Download .ipa from expo.dev
2. Use Transporter app to upload to App Store Connect
3. In App Store Connect, add to TestFlight

**Note:** First submission may require:
- App Store Connect app listing (basic metadata)
- Compliance questionnaire (encryption, CCPA)
  </action>
  <verify>
- Submission initiated without errors
- App visible in App Store Connect / TestFlight
  </verify>
  <done>App submitted to TestFlight</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>iOS app built and submitted to TestFlight</what-built>
  <how-to-verify>
    1. Open TestFlight app on your iOS device
    2. Check if Oly appears in available builds
    3. Install the app via TestFlight
    4. Launch and verify:
       - Animated splash plays correctly
       - App icon shows camera aperture "O"
       - App name shows "Oly"
       - Core features work (camera, darkroom, feed, friends)
       - Push notifications can be enabled
    5. Confirm: App feels cohesive with new branding
  </how-to-verify>
  <resume-signal>Type "approved" if TestFlight install works, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] EAS build succeeds for iOS
- [ ] App submitted to TestFlight
- [ ] TestFlight install works on device
- [ ] Branding (icon, splash, name) correct
- [ ] Core features functional
</verification>

<success_criteria>

- All tasks completed
- iOS build available in TestFlight
- App installs and runs correctly from TestFlight
- Branding consistent throughout
- Phase 13 complete
</success_criteria>

<output>
After completion, create `.planning/phases/13-production-build-branding/13-03-SUMMARY.md`

Include in summary:
- Build ID and duration
- TestFlight version number
- Any issues encountered with Apple credentials
- Verification results
</output>
