---
phase: 17-darkroom-ux-polish
plan: 02
type: execute
---

<objective>
Replace horizontal swipes with downward arc "flick" animation and add on-card confirmation overlays.

Purpose: Make the swipe gesture feel like physically flicking a card away - satisfying and natural.
Output: SwipeablePhotoCard with arc motion exit animation and visual confirmation overlays.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-darkroom-ux-polish/17-CONTEXT.md
@.planning/phases/17-darkroom-ux-polish/17-01-SUMMARY.md

# Key files:
@src/components/SwipeablePhotoCard.js

# Key context from 17-CONTEXT.md:
- Replace Mail-style horizontal swipes with downward arc motion
- "Like flicking a card from your wrist" - card curves downward as it exits
- On-card confirmation overlays (not popups):
  - Swipe left = Archive: gray overlay with box icon
  - Swipe right = Journal: green overlay with checkmark circle icon
  - Swipe down = Delete: overlay with X icon
- Icons should be simple (checkmark circle, box, X) - no emojis
- Enhanced haptic feedback on swipe completion

# Technical approach:
The current Swipeable component from react-native-gesture-handler uses horizontal drag.
For arc motion, we need to:
1. Replace Swipeable with PanGestureHandler for full gesture control
2. Track both X and Y translation
3. Apply rotation based on horizontal direction
4. Animate card along curved path on release
5. Show overlay icons that fade in during swipe
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace Swipeable with PanGestureHandler for arc motion</name>
  <files>src/components/SwipeablePhotoCard.js</files>
  <action>
Rewrite the gesture handling to support arc motion:

1. Remove the Swipeable import, add PanGestureHandler from react-native-gesture-handler
2. Create animated values for translateX, translateY, and rotation
3. Implement onGestureEvent handler to update all three values:
   - translateX and translateY follow finger position
   - rotation = translateX / 15 (degrees) for natural card tilt
4. Implement onHandlerStateChange for release detection:
   - Calculate velocity and final position
   - If horizontal swipe exceeds threshold (abs(translateX) > 100):
     * Archive: translateX < -100 (left swipe)
     * Journal: translateX > 100 (right swipe)
   - If vertical swipe exceeds threshold (translateY > 150):
     * Delete: downward swipe
   - On action trigger: Animate card in arc motion off screen:
     * Exit point: bottom-left or bottom-right corner depending on direction
     * Rotation increases as card exits (15-30 degrees)
     * Duration: 250ms with spring easing
   - On cancel (threshold not met): Spring back to center

5. Wrap the photo card in PanGestureHandler with Animated.View
6. Apply transform: [{ translateX }, { translateY }, { rotate }]

Arc motion formula:
- translateY = translateY + abs(translateX) * 0.3 (card curves down as it moves sideways)
- Exit animation: Both X and Y animate to off-screen position
  </action>
  <verify>Swipe gestures move card in arc motion, card rotates with swipe direction</verify>
  <done>Card follows finger with rotation, curves downward on horizontal swipes, spring-back on cancel</done>
</task>

<task type="auto">
  <name>Task 2: Add on-card confirmation overlays</name>
  <files>src/components/SwipeablePhotoCard.js</files>
  <action>
Add overlay icons that appear ON the photo card as it's being swiped:

1. Create overlay container positioned absolutely over the photo card
2. Add three overlay views (only one visible at a time based on swipe direction):
   - Archive overlay: Gray (#8E8E93) background, opacity animates 0→0.7
   - Journal overlay: Green (#34C759) background, opacity animates 0→0.7
   - Delete overlay: Red (#FF3B30) background, opacity animates 0→0.7

3. Icons (centered in overlay, white color, ~60px):
   - Archive: Box icon - "☐" or simple box SVG/view
   - Journal: Checkmark circle - "✓" with circular border
   - Delete: X icon - "✕"

   Note: Use styled View components or Text for icons to avoid emoji. For example:
   - Checkmark: View with borderWidth forming circle, Text "✓" inside
   - Box: View with borderWidth forming square
   - X: Two crossed View lines with rotation

4. Overlay opacity calculation:
   - Archive: opacity = clamp(abs(translateX) / 100, 0, 0.7) when translateX < 0
   - Journal: opacity = clamp(translateX / 100, 0, 0.7) when translateX > 0
   - Delete: opacity = clamp(translateY / 150, 0, 0.7) when translateY > 0

5. Apply borderRadius to overlay to match card corners
  </action>
  <verify>Swipe left shows gray box overlay, swipe right shows green checkmark overlay, swipe down shows red X overlay</verify>
  <done>Overlays fade in proportionally to swipe distance, icons are clean shapes (not emojis)</done>
</task>

<task type="auto">
  <name>Task 3: Enhanced haptic feedback for flick gestures</name>
  <files>src/components/SwipeablePhotoCard.js</files>
  <action>
Improve haptic feedback to match the satisfying flick gesture:

1. On swipe threshold reached (before release): Light impact haptic as "preview" of action
2. On card exit animation start: Medium impact haptic (existing pattern)
3. On card fully off screen: Heavy impact haptic for completion feedback

Haptic timing:
- threshold crossed (during drag): Haptics.impactAsync(Light)
- release confirmed action: Haptics.impactAsync(Medium)
- animation complete: Haptics.impactAsync(Heavy)

Add a state variable to track if threshold haptic was already triggered (prevent repeated haptics during single swipe).

For delete (downward swipe), consider using notificationAsync(Warning) for the "danger" feel.
  </action>
  <verify>Haptic feedback fires at threshold, on release, and on completion - three distinct moments</verify>
  <done>Three-stage haptic feedback: preview at threshold, confirmation on release, completion on exit</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>New flick-style swipe animation with arc motion, on-card overlays, and enhanced haptics</what-built>
  <how-to-verify>
    1. Run: npx expo start
    2. Navigate to Darkroom with photos ready
    3. Test swipe gestures:
       - Swipe left: Card should arc downward-left with gray box overlay
       - Swipe right: Card should arc downward-right with green checkmark overlay
       - Swipe down: Card should drop with red X overlay
    4. Verify arc motion feels like "flicking a card from your wrist"
    5. Verify haptic feedback has three stages (threshold, release, complete)
    6. Verify overlays use clean icons (not emojis)
    7. Verify spring-back animation when swipe doesn't reach threshold
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Card follows arc motion (curves downward as it moves sideways)
- [ ] Card rotates in direction of swipe
- [ ] On-card overlays appear with correct colors and icons
- [ ] Overlays use non-emoji icons (shapes/text)
- [ ] Three-stage haptic feedback works
- [ ] Spring-back animation when threshold not met
- [ ] All three swipe directions trigger correct action
</verification>

<success_criteria>
- All tasks completed
- Flick gesture feels natural and satisfying
- Visual overlays provide clear feedback without popups
- Haptics enhance the physical feel
- User approves the new interaction pattern
</success_criteria>

<output>
After completion, create `.planning/phases/17-darkroom-ux-polish/17-02-SUMMARY.md` following the summary template.

**Phase 17 Complete** - Ready for Phase 18: Reaction Notification Debouncing
</output>
