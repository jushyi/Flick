# Milestone v0.7.1: Rewind Rebrand & Feed Overhaul

**Status:** SHIPPED 2026-01-26
**Phases:** 30-37.2
**Total Plans:** 34

## Overview

This milestone transformed the app identity to Rewind while overhauling the feed experience with new navigation, notifications, stories, and comments. The milestone delivered a complete visual rebrand with purple/pink gradients, Instagram-style 3-tab navigation, activity feed with notifications, edge-to-edge feed cards, stories with 3D cube transitions, and a full comments system with threading, media support, and push notifications.

## Phases

### Phase 30: Rewind Rebrand

**Goal**: Complete identity overhaul - new name "Rewind", purple/pink color palette, cassette tape app icon, splash screen
**Depends on**: Previous milestone complete
**Plans**: 5 plans + 3 fixes

Plans:

- [x] 30-01: Design Tokens - Rewind brand palette with purple/pink gradients
- [x] 30-02: Brand Assets - Cassette tape icon, splash screen, favicon
- [x] 30-03: App Configuration - app.json identity, Oly references removed
- [x] 30-04: Animated Splash Rebrand - Purple blades on dark background with blur-to-focus effect
- [x] 30-05: Darkroom Design Tokens - Purple to pink color storytelling for reveal animation
- [x] 30-FIX: EAS ProjectId Mismatch Resolution - Reinitialize EAS for Rewind slug

**Details:**
New brand identity with cassette tape iconography representing the "rewind" theme. Purple (#7C3AED) as primary brand color with pink (#EC4899) accents. Animated splash screen features rotating blades that blur-to-focus. Darkroom reveal animation uses purple base with pink fill for anticipation/payoff storytelling.

### Phase 31: Personalization Scaffolding

**Goal**: Theme context/infrastructure for users to change color palettes (future feature prep)
**Depends on**: Phase 30
**Plans**: 1 plan

Plans:

- [x] 31-01: ThemeContext infrastructure with preset palettes and AsyncStorage persistence

**Details:**
React Context for theme management with preset palettes. AsyncStorage persistence for user preferences. Foundation for future personalization features.

### Phase 32: Navigation Restructure

**Goal**: 4 tabs to 3 tabs (Feed, Camera center, Profile) - Instagram-style layout
**Depends on**: Phase 31
**Plans**: 1 plan

Plans:

- [x] 32-01: Restructure tabs and relocate Friends screens to root stack

**Details:**
Removed dedicated Friends tab. Camera remains center position. Feed (left) and Profile (right) as primary tabs. Friends screens relocated to root stack for navigation from Activity screen.

### Phase 33: Feed Header & Notifications

**Goal**: Logo + notifications bell header, activity feed + friend requests combined (Instagram-style activity)
**Depends on**: Phase 32
**Plans**: 2 plans

Plans:

- [x] 33-01: ActivityScreen with MaterialTopTabNavigator, navigation wiring from feed
- [x] 33-02: NotificationsTab with pinned requests, FriendsTab with search/list, mark-as-read

**Details:**
Instagram-style activity page with tabbed interface. Notifications tab shows reaction notifications with pinned friend requests at top. Friends tab provides search and friend list management. Mark-as-read functionality using Firestore batch updates.

### Phase 34: Feed Card Redesign

**Goal**: Complete overhaul of card layout, interaction patterns, loading/transitions
**Depends on**: Phase 33
**Plans**: 1 plan

Plans:

- [x] 34-01: Polaroid frame styling - cream color, thick bottom border, user info

**Details:**
Initial Polaroid-style card design with cream background. Later replaced in Phase 34.1 with Instagram-style full-width design.

### Phase 34.1: Instagram-Style Full-Width Feed Cards (INSERTED)

**Goal**: Replace Polaroid frame with Instagram-style full-width photos
**Depends on**: Phase 34
**Plans**: 1 plan

Plans:

- [x] 34.1-01: Edge-to-edge feed cards with profile photo row

**Details:**
Pure black background (#000000) matching stories section. Screen-width photos with no card margins. Profile photo and user info positioned horizontally below photo.

### Phase 34.2: Feed & Stories UI Refinements (INSERTED)

**Goal**: Stories row hides on scroll, story cards redesign, profile photo overlaps
**Depends on**: Phase 34.1
**Plans**: 1 plan

Plans:

- [x] 34.2-01: Scrollable stories, rectangular story cards with profile photo, feed cards horizontal layout

**Details:**
Stories row scrolls with feed content. Story cards changed to 88x130 rectangular with profile photo at bottom. Feed cards retain horizontal info row layout.

### Phase 35: Stories Redesign

**Goal**: Complete visual and interaction overhaul of stories row
**Depends on**: Phase 34
**Plans**: 3 plans

Plans:

- [x] 35-01: Polaroid story cards with blurred thumbnails and gradient glow
- [x] 35-02: View state tracking and stories sorting (unviewed first)
- [x] 35-03: Hot highlights feed filter (engagement-based curation)

**Details:**
Gradient glow around story cards using brand colors. 24-hour expiry for viewed state with daily reset. Stories sorted with unviewed friends first. Hot highlights filter showing MIN_REACTIONS_FOR_HOT = 2.

### Phase 35.1: Unified Photo Modal (INSERTED)

**Goal**: Combine stories modal and feed modal into single component
**Depends on**: Phase 35
**Plans**: 1 plan

Plans:

- [x] 35.1-01: Merge PhotoDetailModal and stories viewer with conditional story segments

**Details:**
Single PhotoDetailModal component with mode prop ('stories' or 'feed'). Story segments only appear in stories mode. Feed photos do not trigger viewed state. Reduces code duplication.

### Phase 35.2: Feed Header & Bottom Padding (INSERTED)

**Goal**: Black header bar, scroll-hide behavior, bottom padding for tab bar
**Depends on**: Phase 35.1
**Plans**: 1 plan

Plans:

- [x] 35.2-01: Black header with scroll-hide behavior, bottom content inset for tab bar

**Details:**
HEADER_HEIGHT = 68, TAB_BAR_HEIGHT = 88 based on safe area calculations. Header uses clamp extrapolation to prevent over-scroll issues. Bottom padding prevents tab bar clipping last card.

### Phase 35.3: Stories Performance & View State Fix (INSERTED)

**Goal**: Fix clunky story navigation and incorrect view state tracking
**Depends on**: Phase 35.2
**Plans**: 1 plan

Plans:

- [x] 35.3-01: expo-image for instant loads, hasViewedAllPhotos for accurate ring color

**Details:**
expo-image replaces RN Image for native caching. Instant photo cuts instead of 200ms fade. Ring color based on ALL photos viewed, not just modal open state.

### Phase 35.4: Stories Feed Data & Resume Fix (INSERTED)

**Goal**: Fix stories not showing all photos, incorrect ordering, and resume tracking
**Depends on**: Phase 35.3
**Plans**: 1 plan + 1 fix

Plans:

- [x] 35.4-01: Fix stories to fetch all photos in chronological order, fix resume tracking
- [x] 35.4-01-FIX: UAT fixes - progress bar visibility, Firestore viewed state, cube transitions

**Details:**
Fetch ALL journal photos (not just top 5). Chronological order (oldest first) for timeline viewing. Firestore subcollection for per-user viewed state persistence. Dynamic segment width with auto-scroll for progress bar. 3D cube rotation for friend transitions. 80ms minimum display time for rapid taps.

### Phase 35.5: Feed Layout Polish (INSERTED)

**Goal**: Align progress bar and emoji footer, remove Feed header
**Depends on**: Phase 35.4
**Plans**: 1 plan

Plans:

- [x] 35.5-01: Edge-to-edge progress bar/footer, remove Feed header and stories border

**Details:**
Progress bar and emoji footer aligned with 8px padding matching photo marginHorizontal. Removed "Feed" header text for seamless stories-to-cards transition.

### Phase 36: Comments Feature

**Goal**: Bottom sheet for photo comments with full social features
**Depends on**: Phase 35
**Plans**: 6 plans + 5 fixes

Plans:

- [x] 36-01: Comment service layer with CRUD operations and Firestore rules
- [x] 36-02: Comments UI components (CommentRow, CommentInput, CommentsBottomSheet)
- [x] 36-03: Comments bottom sheet integration with preview comments
- [x] 36-03-FIX: UAT Round 2 fixes (sheet closing, keyboard, feed mode tap, alignment, rotation)
- [x] 36-03-FIX-2: UAT Round 3 fixes (rotation timing, showViewAll, spacing, input alignment)
- [x] 36-03-FIX-3: UAT Round 4 fixes (swipe gestures, keyboard sheet movement, spacing polish)
- [x] 36-03-FIX-4: UAT Round 5 fixes (gesture detection, keyboard offset, UI spacing)
- [x] 36-03-FIX-5: UAT Round 6 fixes (feed swipe-to-close, border radius, user info position, dot spacing)
- [x] 36-04: Comment likes and delete functionality
- [x] 36-05: Comment threading replies
- [x] 36-06: Comment notifications & media comments (images, GIFs)

**Details:**
Full comment system with commentService.js (CRUD operations). CommentsBottomSheet with 60% height, swipe-to-close. Comment preview with 2-second rotation. Threading replies with visual nesting. Like/delete functionality. Push notifications via Cloud Function. Image picker for photo comments. Giphy SDK integration (disabled for Expo Go, enabled for dev client).

### Phase 36.1: Comment Sheet Fullscreen Expand (INSERTED)

**Goal**: Swipe up on comment sheet handle to expand to full screen
**Depends on**: Phase 36
**Plans**: 1 plan

Plans:

- [x] 36.1-01: Bidirectional expand/collapse gesture with velocity-based snapping

**Details:**
EXPANDED_HEIGHT = 85% (not 95% to avoid notch). Bidirectional PanResponder on handle bar. Velocity-based snapping (vy > 0.5 = instant snap). Nested Animated.Views to separate JS driver (height) from native driver (transforms). isExpandedRef for PanResponder closure access.

### Phase 37: Profile Placeholder

**Goal**: Minimal profile with Friends button only (full refactor deferred)
**Depends on**: Phase 36
**Plans**: 1 plan

Plans:

- [x] 37-01: Minimal placeholder with Friends and Sign Out buttons only

**Details:**
Stripped ProfileScreen to minimal placeholder. Friends button navigates to FriendsListScreen. Sign Out button with confirmation. Full profile redesign deferred to later milestone.

### Phase 37.1: Darkroom Visual Feedback (INSERTED)

**Goal**: Color gradient on darkroom buttons indicating readiness state
**Depends on**: Phase 37
**Plans**: 1 plan + 1 fix

Plans:

- [x] 37.1-01: Gradient state indicator on card button and hold button
- [x] 37.1-01-FIX: Radial gradient fix for darkroom state indicators

**Details:**
Purple-heavy gradient when developing, pink-heavy when ready. Gradient applied to both card stack button on camera screen and hold-to-reveal button in bottom sheet. Press-and-hold interaction retained after testing swipe-to-reveal alternative.

### Phase 37.2: Stories Thumbnail Flash Fix & Feed Skeleton Update (INSERTED)

**Goal**: Fix stories thumbnails flashing gray on modal dismiss, update feed loading skeleton
**Depends on**: Phase 37.1
**Plans**: 1 plan

Plans:

- [x] 37.2-01: expo-image for story thumbnails, feed skeleton rewrite

**Details:**
expo-image with cachePolicy='memory-disk' prevents gray flash when dismissing photo modal. RNImage retained for profile photos (small size, no flash issue). Feed loading skeleton updated to reflect current feed structure with stories row and edge-to-edge cards.

---

## Milestone Summary

**Decimal Phases:**

- Phase 34.1: Instagram-Style Full-Width Feed Cards (inserted after Phase 34 for user-requested design change)
- Phase 34.2: Feed & Stories UI Refinements (inserted after Phase 34.1 for stories/feed polish)
- Phase 35.1: Unified Photo Modal (inserted after Phase 35 for code consolidation)
- Phase 35.2: Feed Header & Bottom Padding (inserted after Phase 35.1 for UI polish)
- Phase 35.3: Stories Performance & View State Fix (inserted after Phase 35.2 for performance)
- Phase 35.4: Stories Feed Data & Resume Fix (inserted after Phase 35.3 for data/UX fixes)
- Phase 35.5: Feed Layout Polish (inserted after Phase 35.4 for alignment fixes)
- Phase 36.1: Comment Sheet Fullscreen Expand (inserted after Phase 36 for UX enhancement)
- Phase 37.1: Darkroom Visual Feedback (inserted after Phase 37 for UX enhancement)
- Phase 37.2: Stories Flash & Feed Skeleton (inserted after Phase 37.1 for bug fix + skeleton update)

**Key Decisions:**

- Rewind cassette tape brand identity over Oly aperture
- 3-tab navigation (Feed, Camera, Profile) Instagram-style
- Edge-to-edge photos over Polaroid card styling
- Firestore subcollection for per-user viewed stories state
- 3D cube rotation for friend-to-friend story transitions
- 85% expanded comment sheet (not 95%) to avoid notch
- Press-and-hold over swipe-to-reveal for darkroom
- expo-image for story thumbnails to prevent flash

**Issues Resolved:**

- Stories thumbnails flashing gray on modal dismiss
- Incorrect view state tracking (ring color before all stories viewed)
- Stories not showing all journaled photos from friends
- Progress bar flying off screen with many photos
- Comment sheet gesture conflicts with photo swipe
- Animated driver conflicts (JS vs native)

**Issues Deferred:**

- ISS-002: External dashboard rebranding (Firebase, Google Cloud, Expo) - batch with TestFlight prep
- Full profile redesign with photo gallery
- TestFlight submission

**Technical Debt Incurred:**

- Giphy SDK disabled for Expo Go compatibility (code preserved as comments)
- Profile screen is minimal placeholder (full redesign deferred)

---

_For current project status, see .planning/ROADMAP.md_
